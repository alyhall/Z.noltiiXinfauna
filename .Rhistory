filter(Shade_Per == "100") %>%
ggplot(aes( x = Dur, y = CO2, color = Current_Location)) +
geom_point()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
filter(Shade_Per == "100") %>%
ggplot(aes( x = Dur, y = CO2, color = Meso)) +
geom_point()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
filter(Shade_Per == "100") %>%
ggplot(aes( x = Dur, y = CO2, color = Mesocosm_Treatment)) +
geom_point()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
filter(Shade_Per == "100") %>%
ggplot(aes( x = Dur, y = CO2, color = Mesocosm_Treatment)) +
geom_violin()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
filter(Shade_Per == "100") %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, color = Mesocosm_Treatment)) +
geom_violin()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, color = Shade_Per)) +
geom_violin()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CH4, color = Shade_Per)) +
geom_violin()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, color = Shade_Per)) +
geom_violin()
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux)) +
geom_violin() +
facet_wrap(~Shade_Per, scales = "free_y")
Slope <- Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
group_by(Mesocosm_Treatment, Replicate, Shade_Per) %>%
summarise(
CO2_fit = list(lm(as.numeric(CO2) ~ as.numeric(Dur))),
CH4_fit = list(lm(as.numeric(CH4) ~ as.numeric(Dur))),
.groups = "drop"
) %>%
mutate(
CO2flux = (map_dbl(CO2_fit, ~ coef(.x)[[2]]))*60,  # slope of CO2 ~ min
CH4flux = (map_dbl(CH4_fit, ~ coef(.x)[[2]]))*60   # slope of CH4 ~ min
) %>%
select(-CO2_fit, -CH4_fit)
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux)) +
geom_violin() +
facet_wrap(~Shade_Per, scales = "free_y")
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux, color = Shade_Per)) +
geom_violin() +
facet_wrap(~Shade_Per, scales = "free_y")
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux, color = Shade_Per)) +
geom_violin()
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux, color = Shade_Per)) +
geom_violin() +
facet_wrap(~Shade_Per, scales = "free_y")
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, color = Shade_Per)) +
geom_violin()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 60) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CH4, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_minimal()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 60) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CH4, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, color = Shade_Per)) +
geom_violin() +
theme_bw()
Combo %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Combo %>%
# filter(Dur < 241) %>%
# filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Light <- read_excel("Data/Mesocosm_lightfield.xlsx")
View(Light)
select(c(Pot_Location, Water))
Light %>%
select(c("Pot_Location", "Water")
Light %>%
Light %>%
select(c("Pot_Location", "Water"))
by = c("Current_Location" = "Pot_Location")
right_join(Light %>%
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Combo %>%
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Light <- read_excel("Data/Mesocosm_lightfield.xlsx") %>%
mutate(Pot_Location = as.character(Pot_Location))
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Light <- read_excel("Data/Mesocosm_lightfield.xlsx") %>%
mutate(Pot_Location = as.numeric(Pot_Location))
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Combo <-
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Combo %>%
# filter(Dur < 241) %>%
# filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Water)) +
facet_wrap(~Shade_Per, scales = "free_y") +
geom_violin() +
theme_bw()
Combo %>%
# filter(Dur < 241) %>%
# filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Combo <-
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location")) %>%
remove_na()
Combo <-
Combo %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location")) %>%
na.omit()
Combo %>%
# filter(Dur < 241) %>%
# filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Combo <-
fuzzy_left_join(
GHG,
Measure,
by = c("TIME" = "Start_Time", "TIME" = "End_Time"),
match_fun = list(`>=`, `<=`))
Gasflux <-
Combo %>%
mutate(Dur = difftime(Combo$TIME, Combo$Start_Time)) %>% # Create a column for runtime
filter(!Dur == "NA") # Remove the NA (between measurements and before machine started)
Gasflux <-
Gasflux %>%
right_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location")) %>%
na.omit()
View(Gasflux)
Gasflux %>%
# filter(Dur < 241) %>%
# filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 60) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CH4, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 60) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux <-
Combo %>%
mutate(Dur = difftime(Combo$TIME, Combo$Start_Time)) %>% # Create a column for runtime
filter(!Dur == "NA") # Remove the NA (between measurements and before machine started)
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux <-
Gasflux %>%
left_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location")) %>%
na.omit()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux <-
Gasflux %>%
left_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location")) %>%
na.omit()
Gasflux <-
Combo %>%
mutate(Dur = difftime(Combo$TIME, Combo$Start_Time)) %>% # Create a column for runtime
filter(!Dur == "NA") # Remove the NA (between measurements and before machine started)
Gasflux <-
Gasflux %>%
left_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 60) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 1) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 30) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
# filter(Dur < 241) %>%
# filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Gasflux <-
Combo %>%
mutate(Dur = difftime(Combo$TIME, Combo$Start_Time)) %>% # Create a column for runtime
filter(!Dur == "NA") # Remove the NA (between measurements and before machine started)
Gasflux <-
Gasflux %>%
left_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Gasflux %>% Gasflux %>% CO2
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Slope <- Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 40) %>%
group_by(Mesocosm_Treatment, Replicate, Shade_Per) %>%
summarise(
CO2_fit = list(lm(as.numeric(CO2) ~ as.numeric(Dur))),
CH4_fit = list(lm(as.numeric(CH4) ~ as.numeric(Dur))),
.groups = "drop"
) %>%
mutate(
CO2flux = (map_dbl(CO2_fit, ~ coef(.x)[[2]]))*60,  # slope of CO2 ~ min
CH4flux = (map_dbl(CH4_fit, ~ coef(.x)[[2]]))*60   # slope of CH4 ~ min
) %>%
select(-CO2_fit, -CH4_fit)
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux, color = Shade_Per)) +
geom_violin() +
facet_wrap(~Shade_Per, scales = "free_y")
Slope %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2flux, color = Shade_Per)) +
geom_violin() +
facet_wrap(~Shade_Per, scales = "free_y") +
theme_bw()
Light <- read_excel("Data/Mesocosm_lightfield.xlsx") %>%
mutate(Pot_Location = as.numeric(Pot_Location),
Water = as.numeric(Water))
Gasflux <-
Gasflux %>%
left_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
# filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Dur, y = CO2, color = Water)) +
geom_point() +
facet_wrap(~Shade_Per, scales = "free_y") +
theme_bw()
Combo <-
fuzzy_left_join(
GHG,
Measure,
by = c("TIME" = "Start_Time", "TIME" = "End_Time"),
match_fun = list(`>=`, `<=`))
Gasflux <-
Combo %>%
mutate(Dur = difftime(Combo$TIME, Combo$Start_Time)) %>% # Create a column for runtime
filter(!Dur == "NA") # Remove the NA (between measurements and before machine started)
Gasflux <-
Gasflux %>%
left_join(Light %>%
select(c("Pot_Location", "Water")),
by = c("Current_Location" = "Pot_Location"))
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Dur, y = CO2, color = Water)) +
geom_point() +
facet_wrap(~Shade_Per, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Dur, y = CO2, color = Mesocosm_Treatment)) +
geom_point() +
facet_wrap(~Shade_Per, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
library(tidyverse)
library(readxl)
library(fuzzyjoin)
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
# filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
# filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
# facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Mesocosm_Treatment, y = CO2, fill = Shade_Per)) +
geom_violin() +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
ggplot(aes( x = Dur, y = CO2, color = Mesocosm_Treatment)) +
geom_point() +
facet_wrap(~Shade_Per, scales = "free_y") +
theme_bw()
Gasflux %>%
filter(Dur < 241) %>%
filter(Dur > 120) %>%
filter(Mesocosm_Treatment == "MED") %>%
ggplot(aes( x = Dur, y = CO2, color = Shade_Per)) +
geom_point() +
facet_wrap(~Replicate, scales = "free_y") +
theme_bw()
